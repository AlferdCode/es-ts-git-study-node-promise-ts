"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[503],{7503:function(t,e,s){s.r(e),s.d(e,{default:function(){return l}});var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"detail"},[e("div",{staticClass:"item"},[e("div",{staticClass:"magnifier"},[e("Magnifier",{attrs:{width:"500px",imgsrc:t.shop.img_list_url}})],1),e("div",{staticClass:"dec"},[e("span",{staticClass:"title"},[t._v(t._s(t.shop.title))]),e("p",{staticClass:"price"},[e("span",[t._v("价格:")]),t._v(" "+t._s(t.shop.price)+" "),e("span",[t._v("¥")])]),e("el-button",{attrs:{type:"danger"},on:{click:function(e){return t.addShopCar(t.shop.Id)}}},[t._v("加入购物车")])],1)]),e("div",{staticClass:"list"},[e("h1",[t._v("相关商品")]),t._l(t.shoplist,(function(s,i){return[i<8?e("shop",{key:i,attrs:{shop:s,imgHeight:"250px"},on:{onShopClick:t.replaceLink}}):t._e()]}))],2)])},n=[],o=s(2649),a={name:"Detail",data(){return{shop:{},shoplist:[]}},created(){this.getDetail(),this.getTypeOneShop()},methods:{getDetail(){let t=this.$route.params.id;(0,o.Nm)(t).then((t=>{this.shop=t[0]}))},getTypeOneShop(){let t=this.$route.query.type_one;console.log(t),(0,o.IU)(t).then((t=>{this.shoplist=t}))},replaceLink(t){this.$router.replace(`/detail/${t.Id}?type_one=${t.type_one}`)},addShopCar(t){let{token:e,username:s}=this.$store.state.user;this.permission(e).then((i=>{if(i){let i={goodId:t,token:e,username:s};(0,o.fy)(i).then((t=>{console.log(t),1==t.code&&this.$message({message:"添加购物车成功",type:"success"}),2==t.code&&this.$message({message:"添加失败",type:"danger"})}))}}))},permission(t){return new Promise(((e,s)=>{t&&e(!0),t||(this.$confirm("您还未登录，是否先登录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$router.push("/login")})).catch((()=>{this.$message({type:"info",message:"已取消登录"})})),e(!1))}))}},watch:{$route:{deep:!0,handler(t,e){this.getDetail(),this.getTypeOneShop()}}}},r=a,p=s(1001),h=(0,p.Z)(r,i,n,!1,null,"4485eb8d",null),l=h.exports},2649:function(t,e,s){s.d(e,{IU:function(){return o},Nm:function(){return n},fy:function(){return a}});var i=s(4471);function n(t){return(0,i.Z)({url:"/api/detail",method:"get",params:{goodId:t}})}function o(t){return(0,i.Z)({url:"/api/goodList",method:"get",params:{type_one:t}})}function a(t){return(0,i.Z)({url:"/api/add",method:"get",params:{...t}})}}}]);
//# sourceMappingURL=503.863b62b3.js.map