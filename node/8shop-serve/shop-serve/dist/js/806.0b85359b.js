"use strict";(self["webpackChunkshop"]=self["webpackChunkshop"]||[]).push([[806],{7806:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"shopCar"},[t("div",{staticClass:"shop"},[t("div",{staticClass:"carHeader"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isAll,expression:"isAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isAll)?e._i(e.isAll,null)>-1:e.isAll},on:{change:[function(t){var s=e.isAll,a=t.target,i=!!a.checked;if(Array.isArray(s)){var c=null,r=e._i(s,c);a.checked?r<0&&(e.isAll=s.concat([c])):r>-1&&(e.isAll=s.slice(0,r).concat(s.slice(r+1)))}else e.isAll=i},e.changeAll]}}),t("span",{staticClass:"all"},[e._v("全选")]),t("span",{staticClass:"name"},[e._v("商品详情")]),t("span",{staticClass:"pri"},[e._v("单价")]),t("span",{staticClass:"number"},[e._v("数量")]),t("span",{staticClass:"price"},[e._v("总格")]),t("span",{staticClass:"handle"},[e._v("操作")])]),e._l(e.carList,(function(s,a){return t("div",{key:a,staticClass:"carMain"},[t("div",{staticClass:"mainItem"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.checkeds,expression:"checkeds"}],staticClass:"done",attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(e.checkeds)?e._i(e.checkeds,s)>-1:e.checkeds},on:{change:function(t){var a=e.checkeds,i=t.target,c=!!i.checked;if(Array.isArray(a)){var r=s,n=e._i(a,r);i.checked?n<0&&(e.checkeds=a.concat([r])):n>-1&&(e.checkeds=a.slice(0,n).concat(a.slice(n+1)))}else e.checkeds=c}}}),t("img",{attrs:{src:s.img_list_url,alt:""}}),t("span",{staticClass:"name"},[e._v(e._s(s.title))]),t("span",{staticClass:"pri"},[e._v("￥"+e._s(s.price))]),t("div",{staticClass:"num"},[t("button",{on:{click:function(t){return e.reduce(s)}}},[e._v("-")]),t("span",{attrs:{type:"text"}},[e._v(e._s(s.count))]),t("button",{on:{click:function(t){return e.add(s.Id)}}},[e._v("+")])]),t("span",{staticClass:"price"},[e._v(e._s(s.price*s.count)+"￥")]),t("el-button",{staticClass:"dele",attrs:{type:"info",round:""},on:{click:function(t){return e.deleteShopCar(s.Id)}}},[e._v("删除")])],1)])})),t("div",{staticClass:"carFooter"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.isAll,expression:"isAll"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.isAll)?e._i(e.isAll,null)>-1:e.isAll},on:{change:[function(t){var s=e.isAll,a=t.target,i=!!a.checked;if(Array.isArray(s)){var c=null,r=e._i(s,c);a.checked?r<0&&(e.isAll=s.concat([c])):r>-1&&(e.isAll=s.slice(0,r).concat(s.slice(r+1)))}else e.isAll=i},e.changeAll]}}),t("span",{staticClass:"all"},[e._v("全选")]),t("span",{staticClass:"delect"},[e._v("全部删除")]),t("span",{staticClass:"add"},[e._v("总价：￥"+e._s(e.totalPrice))]),t("el-button",{staticClass:"dele",attrs:{type:"danger",round:""}},[e._v("结算")])],1)],2)])},i=[],c=s(4471);function r(e){return(0,c.Z)({url:"/api/shoplist",method:"get",params:{...e}})}function n(e){return(0,c.Z)({url:"/api/remove",method:"get",params:{...e}})}function l(e){return(0,c.Z)({url:"/api/del",method:"get",params:{...e}})}var o=s(2649),d={name:"ShopCar",data(){return{carList:[],flag:!0,checkeds:[],isAll:!1,totalPrice:0}},methods:{reduce(e){if(e.count>1){let{username:t,token:s}=this.$store.state.user,a=e.Id;n({token:s,username:t,goodId:a}).then((e=>{this.getShopCarList()}))}else this.$message({type:"info",message:"商品已减到最少!!!"})},deleteShopCar(e){this.$confirm("确定删除该商品???","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>{let{username:t,token:s}=this.$store.state.user;l({token:s,username:t,goodId:e}).then((()=>{this.getShopCarList(),this.$message({type:"success",message:"商品已删除"})})).catch((()=>{this.$message({type:"danger",message:"商品删除失败，请刷新后重试"})}))})).catch((()=>{this.$message({type:"info",message:"已取消删除"})}))},add(e){if(this.flag){this.falg=!1;let{token:t,username:s}=this.$store.state.user;(0,o.fy)({token:t,username:s,goodId:e}).then((e=>{this.falg=!0,this.getShopCarList()}))}},getShopCarList(){let{token:e,username:t}=this.$store.state.user;r({token:e,username:t}).then((e=>{console.log("获取成功",e),this.carList=e}))},changeAll(){this.isAll?this.checkeds=this.carList:this.checkeds=[]}},created(){this.getShopCarList()},mounted(){},beforeUpdate(){},updated(){},watch:{checkeds:{deep:!0,handler(e){let t=0;e.forEach((e=>{t+=parseInt(e.count)*parseFloat(e.price)})),this.totalPrice=t,e.length===this.carList.length?this.isAll=!0:this.isAll=!1}}}},h=d,u=s(1001),p=(0,u.Z)(h,a,i,!1,null,"7637aab2",null),m=p.exports},2649:function(e,t,s){s.d(t,{IU:function(){return c},Nm:function(){return i},fy:function(){return r}});var a=s(4471);function i(e){return(0,a.Z)({url:"/api/detail",method:"get",params:{goodId:e}})}function c(e){return(0,a.Z)({url:"/api/goodList",method:"get",params:{type_one:e}})}function r(e){return(0,a.Z)({url:"/api/add",method:"get",params:{...e}})}}}]);
//# sourceMappingURL=806.0b85359b.js.map